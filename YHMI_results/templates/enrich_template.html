{% load myfilter %}
{% include "inputGene.html" %}

<div class="card mb-3">
  <div class="card-header">
    <i class="fa fa-fw fa-table"></i> Resultsã€€&#40;Corrected Method: 
    {% if corrected == '1' %}
      Bonferroni-corrected, cutoff=10<sup>-{{ cutoff }}</sup> &#41;
    {% else %}
      FDR (False Discovery Rate), &alpha;=10<sup>-{{ cutoff }}</sup> &#41;;
    {% endif %}
  </div>

  <div class="m-2">
    <ul class="nav nav-tabs mb-2">
      {% for ftype in enrich_value.keys %}
        <li class="nav-item">
          {% if forloop.first %}
            <a class="nav-link active mr-2" data-toggle="tab" href="#{{ ftype }}_tab">{{ ftype|remove_underline }}</a>
          {% else %}
            <a class="nav-link mr-2" data-toggle="tab" href="#{{ ftype }}_tab">{{ ftype|remove_underline }}</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>

    <div class="tab-content">
      {% for ftype,fdata in enrich_value.items %}
        {% if forloop.first %}
          <div id="{{ftype}}_tab" class="tab-pane fade active show">
        {% else %}
          <div id="{{ftype}}_tab" class="tab-pane fade">
        {% endif %}
          
        {% if ftype != 'H2A_Variant_and_H2B_Ubiquitination' %}
          <table class='table p-1' id="{{ftype}}_enrich_table">
            <thead>
              <th class="text-left" style="width:30%;">Name</th>
              <th class="text-left" style="width:10%;">Paper</th>
              <th class="text-right" style="width:20%;">Intersects / <br># of input genes</th>
              <th class="text-right" style="width:25%;">Histone Modification / <br># of genes in the yeast genome</th>
              {% if ftype == 'TF' %}
                <th class="text-right" style="width:15%;">P-value</th>
              {% else %}
                <th class="text-right" style="width:9%;">P-value</th>
                <th class="text-right" style="width:6%;">Side</th>
              {% endif %}
            </thead>
            <tbody>
              {% for value in fdata %}
                <tr>
                  <td class="text-left">{{ value.feature }} {{ value.enrich_type|now_type}}</td>
                  <td class="text-left">{{ value.paper }}</td>
                  <td class="text-right">{{ value.intersectOfgene.0 }}/{{ value.intersectOfgene.1 }}({{ value.intersectOfgene.0|calc_percent:value.intersectOfgene.1 }})</td>
                  <td class="text-right">{{ value.intersectOfgene.2 }}/{{ 6572 }}({{ value.intersectOfgene.2|calc_percent:6572 }})</td>
                  <td class="text-right">{{ value.pvalue.0|format_pvalue }}</td>
                  {% if ftype != 'TF' %}
                    <td class="text-right">{{ value.pvalue.1|pvalue_type }}</td>
                  {% endif %}
                </tr>   
              {% endfor %}
            </tbody>
          </table>
        {% else%}
          {% for fftype,ffdata in enrich_value_others.items %}
            <div class="subtitle mt-2" style="font-size:18px;">{{fftype}}</div>
            <table class="table p-1" id="{{fftype}}_enrich_table">
              <thead>
                <th class="text-left" style="width:30%;">Name</th>
                <th class="text-left" style="width:10%;">Paper</th>
                <th class="text-right" style="width:20%;">Intersects / <br># of input genes</th>
                <th class="text-right" style="width:25%;">Histone Modification / <br># of genes in the yeast genome</th>
                <th class="text-right" style="width:9%;">P-value</th>
                <th class="text-right" style="width:6%;">Side</th>
              </thead>
              <tbody>
                {% for value in ffdata %}
                  <tr>
                    <td class="text-left">{{ value.feature }} {{ value.enrich_type|now_type}}</td>
                    <td class="text-left">{{ value.paper }}</td>
                    <td class="text-right">{{ value.intersectOfgene.0 }}/{{ value.intersectOfgene.1 }}({{ value.intersectOfgene.0|calc_percent:value.intersectOfgene.1 }})</td>
                    <td class="text-right">{{ value.intersectOfgene.2 }}/{{ 6572 }}({{ value.intersectOfgene.2|calc_percent:6572 }})</td>
                    <td class="text-right">{{ value.pvalue.0|format_pvalue }}</td>
                    <td class="text-right">{{ value.pvalue.1|pvalue_type }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          {% endfor %}
        {% endif %}  
        </div>
      {% endfor %}
    </div>
  </div>
</div>
